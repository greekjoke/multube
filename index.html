<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="max-age=3600, must-revalidate" />    
  <title>MulTube</title>
  <script src="https://code.jquery.com/jquery-2.2.4.min.js"
    integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
    crossorigin="anonymous"></script>
  <script src="https://www.youtube.com/iframe_api"></script>       
  <script src="utils.js"></script>  
  <script src="app.js"></script>  
  <script src="task.js"></script>
  <script src="taskyt.js"></script>
  <script src="taskaud.js"></script>
  <!--  
  <script src="taskread.js"></script>
  <script src="taskpic.js"></script>
  <script src="taskifr.js"></script>
  -->
  <script src="draggable.js"></script>
  <link rel="stylesheet" 
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">  
  <link rel="stylesheet" href="style.css">    
  <link rel="icon" type="image/ico" href="favicon.ico"/>  
</head>

<body color-scheme="default">
  <header>
    <div id="logo"><img src="media/logo.svg"/></div>
    <div id="title"><h1>MulTube</h1></div>

    <!-- main menu -->
    <div id="topmenu" class="menu">
      <ul>
        <li>
          <b>Task</b>
          <ul>
            <li action="addTaskYt">Add Youtube video</li>
            <li action="addTaskAudio">Add audio file</li>
            <li action="addTaskText">Add text reading</li>
            <li action="addTaskPic">Add picture</li>
            <li action="addTaskFrame">Add iFrame</li>
            <li action="removeAllTasks">Remove all</li>
          </ul>
        </li>
        <li>
          <b>Preset</b>
          <ul>
            <li action="addPreset">Add preset</li>
            <li action="removePreset">Remove current</li>
            <li>
              <b>List</b>
              <ul action="switchPreset" id="topmenuPresets">
                <li value="default">Default</li>
              </ul>
            </li>            
          </ul>
        </li>
        <li>
          <b>Settings</b>
          <ul>
            <li action="settingsToFile">Export to file</li>
            <li action="settingsFromFile">Import from file</li>            
            <li>
              <b>Color scheme</b>              
              <ul action="switchColors" id="topmenuColors">               
                <li value="default" flag="1"><i class="fa-solid fa-check"></i>Light</li>
                <li value="dark" flag="0"><i class="fa-solid fa-check"></i>Dark</li>
              </ul>
            </li>            
          </ul>          
        </li>
        <li><b><a target="_blank" href="https://greekjoke.github.io/multube/readme.md">Help</a></b></li>
      </ul>
      <!-- /main menu -->

    </div>
    <div id="gctrl">      
      <span class="menu" id="gcMenuSpeed">
        <ul class="inline">
          <li>
            <i title="Speed control" class="fa-solid fa-clock-rotate-left"></i>
            <ul action="gcSpeed">
              <li value="0.25">0.25</li>
              <li value="0.5">0.5</li>
              <li value="0.75">0.75</li>
              <li value="1.0">Normal</li>
              <li value="1.25">1.25</li>
              <li value="1.5">1.5</li>
              <li value="1.75">1.75</li>
              <li value="2.0">2</li>
            </ul>
          </li>
        </ul>          
      </span>      
      <i action="gcStop" title="Stop playing" class="button fa-solid fa-stop"></i>
      <i action="gcPlay" title="Play together" class="button fa-solid fa-play"></i>
      <i action="gcPause" title="Pause" class="button fa-solid fa-pause"></i>
      <i action="gcMute" title="Mute all" class="button fa-solid fa-volume-xmark"></i>
      <i action="gcUnmute" title="Unmute all" class="button fa-solid fa-volume-high"></i>
      <i action="gcRewindRand" title="Rewind to random position" class="button fa-solid fa-shuffle"></i>      
    </div>
  </header>  

  <script type="text/template" id="tpl-task">
    <div class="task draggable drop-receiver">
      <div class="bar handle">
        <span class="icon"><i class="fa-solid fa-flask"></i></span>
        <span class="title">Untitled</span>
        <span class="status"></span>
        <span class="settings menu">
            <ul>
              <li>
                <i class="fa-solid fa-gear"></i>
                <ul class="submenu"></ul>
              </li>
            </ul>          
        </span>
        <span class="remove button" action="taskCmd" value="remove">
          <i class="fa-solid fa-xmark pointer-transparent"></i>          
        </span>
      </div>
      <div class="content-wrap">
        <div class="content">empty</div>
      </div>
    </div> 
  </script>

  <div id="widgets">        
    <div class="placeholder">No any tasks here yet</div>
  </div>
</body>

<script>
  $(document).ready(function() {

    MtApp.samples = {
      'MtTaskYt': [
        { value: 'https://www.youtube.com/watch?v=IjfvlwMcXqM', title: 'Кручу педали' },
        { value: 'https://www.youtube.com/watch?v=ZD6p7AKffPk', title: 'По дороге с облаками' },
        { value: 'https://www.youtube.com/watch?v=nWkKAiCnyyo', title: 'В каждом маленьком ребёнке' },
        { value: 'https://www.youtube.com/watch?v=zp3Ox2yayok', title: 'Сюрприз!' },        
        { value: 'https://youtu.be/3iC4qBOmZ_Q', title: 'Арам-зам-зам' },        
      ],
    };

    MtApp.init();

    $('body').click(function(ev) {
      const elem = $(ev.target);
      const value = elem.attr('value');
      let act = elem.attr('action');
      
      if (!act && !value) return;
      if (!act) act = elem.parent().attr('action');
      if (!act) return;

      let fn = null;
      const recv = [MtApp, window];

      for(const i in recv) {
        const obj = recv[i];
        if (typeof(obj[act]) === 'function') {
          fn = obj[act];
          fn.call(obj, value, ev.target);
          break;
        }
      }

      if (!fn) {
        console.error('invalid action', act, ev.target);
      }      
    });

  });
</script>

</html>
